# 物理系统单元测试指南

## 概述

本文档提供物理系统单元测试的详细说明，包括测试覆盖、运行方式、预期结果和注意事项。

## 测试覆盖

### 1. MarblePhysicsSystemTest.cpp
物理系统核心框架测试（VOI-24）：
- 场景初始化测试
- 魔力露珠发射测试
- 物理更新循环测试
- 边界处理测试（战斗场景反弹）
- 药效强度消耗测试
- 多个魔力露珠测试

### 2. CollisionManagerTest.cpp
碰撞检测系统测试（VOI-25）：
- 碰撞管理器初始化测试
- 注册碰撞体测试
- 圆-圆碰撞检测测试
- 圆-圆无碰撞测试
- 圆-矩形碰撞检测测试
- 空间网格优化测试
- 性能基准测试（100个碰撞体+50个敌人）
- 碰撞事件委托测试

### 3. MarbleActorPoolTest.cpp
混合物理系统测试（VOI-26）：
- 对象池初始化测试
- 对象池获取和归还测试
- 对象池统计信息测试
- 分级降级策略测试
- 对象池性能测试

## 运行方式

### 在UE4编辑器中运行
1. 打开UE4项目
2. 编译C++代码
3. 打开 Window -> Test Automation
4. 搜索 "EchoAlchemist.Physics"
5. 运行所有测试

### 命令行运行
```bash
# 运行所有物理系统测试
UnrealEditor-Cmd.exe ProjectPath -ExecCmds="Automation RunTests EchoAlchemist.Physics"
```

## 测试结果预期

### 性能基准
- 碰撞检测（100个魔药+50个敌人）：<3ms
- 空间网格更新：<1ms
- 物理更新循环：<5ms

### 功能验证
- 所有场景初始化测试应通过
- 所有碰撞检测测试应通过
- 对象池管理测试应通过

## 注意事项
1. MarbleActorPoolTest需要World对象，必须在UE4编辑器中运行
2. 性能测试结果可能因硬件配置而异
3. 部分测试需要完整的UE4环境才能运行

## 相关任务
- VOI-24: 物理系统核心框架
- VOI-25: 碰撞检测系统
- VOI-26: 混合物理系统
